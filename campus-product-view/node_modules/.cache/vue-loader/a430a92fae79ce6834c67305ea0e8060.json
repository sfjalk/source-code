{"remainingRequest":"/Users/macos/Downloads/campus-system/source code/campus-product-view/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Downloads/campus-system/source code/campus-product-view/src/views/user/Address.vue?vue&type=style&index=0&id=3f15c6aa&scoped=true&lang=css","dependencies":[{"path":"/Users/macos/Downloads/campus-system/source code/campus-product-view/src/views/user/Address.vue","mtime":1758037359504},{"path":"/Users/macos/Downloads/campus-system/source code/campus-product-view/node_modules/css-loader/dist/cjs.js","mtime":1767024825496},{"path":"/Users/macos/Downloads/campus-system/source code/campus-product-view/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1767024828942},{"path":"/Users/macos/Downloads/campus-system/source code/campus-product-view/node_modules/postcss-loader/src/index.js","mtime":1767024825763},{"path":"/Users/macos/Downloads/campus-system/source code/campus-product-view/node_modules/cache-loader/dist/cjs.js","mtime":1767024828976},{"path":"/Users/macos/Downloads/campus-system/source code/campus-product-view/node_modules/vue-loader/lib/index.js","mtime":1767024826361}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouYWRkcmVzcy1jb250YWluZXIgew0KICAgIHBhZGRpbmc6IDIwcHg7DQp9DQoNCi5zZWFyY2gtY2FyZCB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCg0KLnNlYXJjaC1mb3JtIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi50YWJsZS1jYXJkIHsNCiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KfQ0KDQoucGFnaW5hdGlvbiB7DQogICAgbWFyZ2luLXRvcDogMjBweDsNCiAgICB0ZXh0LWFsaWduOiByaWdodDsNCn0NCg=="},{"version":3,"sources":["Address.vue"],"names":[],"mappings":";AAmQA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Address.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n    <div class=\"address-container\">\r\n        <!-- 搜索区域 -->\r\n        <el-card class=\"search-card\">\r\n            <el-form :inline=\"true\" :model=\"queryParams\" class=\"search-form\">\r\n                <el-form-item label=\"默认地址\">\r\n                    <el-select v-model=\"queryParams.isDefault\" placeholder=\"请选择\" clearable>\r\n                        <el-option label=\"是\" :value=\"true\"></el-option>\r\n                        <el-option label=\"否\" :value=\"false\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" @click=\"handleSearch\">查询</el-button>\r\n                    <el-button @click=\"resetSearch\">重置</el-button>\r\n                    <el-button type=\"success\" @click=\"showAddDialog\">新增地址</el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n        </el-card>\r\n\r\n        <!-- 地址列表 -->\r\n        <el-card class=\"table-card\">\r\n            <el-table :data=\"addressList\" border style=\"width: 100%\">\r\n                <el-table-column prop=\"id\" label=\"ID\" width=\"80\"></el-table-column>\r\n                <el-table-column prop=\"userId\" label=\"用户ID\" width=\"100\"></el-table-column>\r\n                <el-table-column prop=\"concatPerson\" label=\"收件人\" width=\"120\"></el-table-column>\r\n                <el-table-column prop=\"concatPhone\" label=\"联系电话\" width=\"150\"></el-table-column>\r\n                <el-table-column prop=\"getAdr\" label=\"收货地址\"></el-table-column>\r\n                <el-table-column label=\"默认地址\" width=\"120\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-tag :type=\"scope.row.isDefault ? 'success' : 'info'\">\r\n                            {{ scope.row.isDefault ? '是' : '否' }}\r\n                        </el-tag>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"操作\" width=\"280\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button size=\"mini\" @click=\"handleEdit(scope.row)\">编辑</el-button>\r\n                        <el-button size=\"mini\" type=\"primary\" @click=\"setDefault(scope.row.id)\"\r\n                            :disabled=\"scope.row.isDefault\">\r\n                            设为默认\r\n                        </el-button>\r\n                        <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.row.id)\">删除</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n            <!-- 分页 -->\r\n            <el-pagination @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\"\r\n                :current-page=\"queryParams.current\" :page-sizes=\"[10, 20, 30]\" :page-size=\"queryParams.size\"\r\n                layout=\"total, sizes, prev, pager, next, jumper\" :total=\"total\" class=\"pagination\"></el-pagination>\r\n        </el-card>\r\n\r\n        <!-- 新增/编辑对话框 -->\r\n        <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogVisible\" width=\"50%\">\r\n            <el-form :model=\"addressForm\" :rules=\"rules\" ref=\"addressForm\" label-width=\"100px\">\r\n                <el-form-item label=\"收件人\" prop=\"concatPerson\">\r\n                    <el-input v-model=\"addressForm.concatPerson\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"联系电话\" prop=\"concatPhone\">\r\n                    <el-input v-model=\"addressForm.concatPhone\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"收货地址\" prop=\"getAdr\">\r\n                    <el-input type=\"textarea\" v-model=\"addressForm.getAdr\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"默认地址\">\r\n                    <el-switch v-model=\"addressForm.isDefault\"></el-switch>\r\n                </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n                <el-button type=\"primary\" @click=\"submitForm\">确定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            queryParams: {\r\n                userId: null,\r\n                isDefault: null,\r\n                current: 1,\r\n                size: 10\r\n            },\r\n            addressList: [],\r\n            total: 0,\r\n            dialogVisible: false,\r\n            dialogTitle: '新增地址',\r\n            addressForm: {\r\n                id: null,\r\n                userId: null,\r\n                concatPerson: '',\r\n                concatPhone: '',\r\n                getAdr: '',\r\n                isDefault: false\r\n            },\r\n            rules: {\r\n                userId: [\r\n                    { required: true, message: '请输入用户ID', trigger: 'blur' },\r\n                    { type: 'number', message: '用户ID必须为数字', trigger: 'blur', transform: value => Number(value) }\r\n                ],\r\n                concatPerson: [\r\n                    { required: true, message: '请输入收件人姓名', trigger: 'blur' },\r\n                    { min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'blur' }\r\n                ],\r\n                concatPhone: [\r\n                    { required: true, message: '请输入联系电话', trigger: 'blur' },\r\n                    { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\r\n                ],\r\n                getAdr: [\r\n                    { required: true, message: '请输入收货地址', trigger: 'blur' },\r\n                    { min: 5, max: 100, message: '长度在 5 到 100 个字符', trigger: 'blur' }\r\n                ]\r\n            }\r\n        }\r\n    },\r\n    created() {\r\n        this.fetchAddressList()\r\n    },\r\n    methods: {\r\n        // 获取地址列表\r\n        fetchAddressList() {\r\n            this.$axios.post('/address/queryUser', this.queryParams).then(res => {\r\n                const { data } = res\r\n                if (data.code === 200) {\r\n                    this.addressList = data.data\r\n                    this.total = data.total || 0\r\n                }\r\n            })\r\n        },\r\n        // 搜索\r\n        handleSearch() {\r\n            this.queryParams.current = 1\r\n            this.fetchAddressList()\r\n        },\r\n        // 重置搜索\r\n        resetSearch() {\r\n            this.queryParams = {\r\n                userId: null,\r\n                isDefault: null,\r\n                current: 1,\r\n                size: 10\r\n            }\r\n            this.fetchAddressList()\r\n        },\r\n        // 分页大小变化\r\n        handleSizeChange(size) {\r\n            this.queryParams.size = size\r\n            this.fetchAddressList()\r\n        },\r\n        // 当前页变化\r\n        handleCurrentChange(current) {\r\n            this.queryParams.current = current\r\n            this.fetchAddressList()\r\n        },\r\n        // 显示新增对话框\r\n        showAddDialog() {\r\n            this.dialogTitle = '新增地址'\r\n            this.addressForm = {\r\n                id: null,\r\n                userId: null,\r\n                concatPerson: '',\r\n                concatPhone: '',\r\n                getAdr: '',\r\n                isDefault: false\r\n            }\r\n            this.dialogVisible = true\r\n            this.$nextTick(() => {\r\n                if (this.$refs.addressForm) {\r\n                    this.$refs.addressForm.clearValidate();\r\n                }\r\n            })\r\n        },\r\n        // 显示编辑对话框\r\n        handleEdit(row) {\r\n            this.dialogTitle = '编辑地址'\r\n            this.addressForm = JSON.parse(JSON.stringify(row))\r\n            this.dialogVisible = true\r\n            this.$nextTick(() => {\r\n                if (this.$refs.addressForm) {\r\n                    this.$refs.addressForm.clearValidate();\r\n                }\r\n            })\r\n        },\r\n        // 提交表单\r\n        submitForm() {\r\n            this.$refs.addressForm.validate(valid => {\r\n                if (valid) {\r\n                    if (this.addressForm.id) {\r\n                        // 更新\r\n                        this.$axios.put('/address/update', this.addressForm).then(res => {\r\n                            this.handleResponse(res, '更新成功')\r\n                        })\r\n                    } else {\r\n                        // 新增\r\n                        this.$axios.post('/address/save', this.addressForm).then(res => {\r\n                            this.handleResponse(res, '新增成功')\r\n                        })\r\n                    }\r\n                }\r\n            })\r\n        },\r\n        // 处理响应\r\n        handleResponse(res, msg) {\r\n            const { data } = res\r\n            if (data.code === 200) {\r\n                this.$message.success(msg)\r\n                this.dialogVisible = false\r\n                this.fetchAddressList()\r\n            } else {\r\n                this.$message.error(data.msg || '操作失败')\r\n            }\r\n        },\r\n        // 删除地址\r\n        handleDelete(id) {\r\n            this.$confirm('确认删除该地址吗?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                this.$axios.post('/address/batchDelete', [id]).then(res => {\r\n                    const { data } = res\r\n                    if (data.code === 200) {\r\n                        this.$message.success('删除成功')\r\n                        this.fetchAddressList()\r\n                    }\r\n                })\r\n            }).catch(() => { })\r\n        },\r\n        // 设为默认地址\r\n        setDefault(id) {\r\n            this.$confirm('确认设为默认地址吗?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                const params = {\r\n                    id: id,\r\n\r\n                    isDefault: true\r\n                }\r\n                this.$axios.put('/address/isDefault', params).then(res => {\r\n                    const { data } = res\r\n                    if (data.code === 200) {\r\n                        this.$message.success('设置成功')\r\n                        this.fetchAddressList()\r\n                    } else {\r\n                        this.$message.info(data.msg)\r\n                    }\r\n                })\r\n            }).catch(() => { })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.address-container {\r\n    padding: 20px;\r\n}\r\n\r\n.search-card {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.search-form {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.table-card {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.pagination {\r\n    margin-top: 20px;\r\n    text-align: right;\r\n}\r\n</style>"]}]}